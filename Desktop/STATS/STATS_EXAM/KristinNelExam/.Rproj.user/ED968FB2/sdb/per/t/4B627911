{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Stats Exam\"\nauthor: \"K Nel\"\ndate: \"31 August 2016\"\noutput: html_document\n---\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE)\n```\n\n##Kristin Nel\n\n#Question 1\n\n*Null Hypothesis:* There is no association between sex (independent), and one's body temperature and heart rate (both dependent).\n\n*Alternative Hypothesis:* There is an association between sex (independent), and one's body temperature and heart rate (both dependent).\n\nThere are 2 groups of unpaired data (male and female), and the data is numerical and continuous. The mean and median are almost identical for both variables (temp + HR), so I can conclude the data is parametric. Therefore, I will perform a Student's or unpaired t-test. \n\n*The assumptions for this test are as follows:*\nThe distribution for the data in the population is Gaussian; there is equal variance across groups; the errors are independent; and the data are unmatched.\n```{r chunk1, echo=FALSE}\n#Load packages\nlibrary(readr)\nlibrary(dplyr)\nlibrary(tidyr)\n\n#Read directly from URL\ndata_q1 <- read.csv('https://dl.dropboxusercontent.com/u/11805474/painblogr/biostats/exam-data-2016/question1.csv')\n\n#Load data into a data frame table\ntable_q1 <- tbl_df(data_q1)\n\n#Clean Data\n##Gather Male and Female Columns into a Sex Column\ngather_sex <- gather(table_q1, key = Sex, value = heart_rate, male, female)\n\n##Filter out data with NA\nno_na <- filter(gather_sex, !is.na(heart_rate))\n\n##Order table columns in more logical order\ntidy_q1 <- select(no_na, Sex, body_temperature, heart_rate)\nprint(tidy_q1)\n\n#Quicklook at data\nboxplot(body_temperature~Sex, data = tidy_q1)\n#At a quick glance, females have a higher average body temp than males, however males have a larger variation around the mean.\nboxplot(heart_rate~Sex, data = tidy_q1)\n#At a quick glance, females have a higher average heart rate than males, and they have a larger variation around the mean.\n\n#Perform t-test on body temperature data\nt.test(body_temperature~Sex, data=tidy_q1, paired=FALSE)\n#Perform t-test on heart rate data\nt.test(heart_rate~Sex, data=tidy_q1, paired=FALSE)\n\n#Produce summary of tidy_q1 data\nsummary(tidy_q1)\n\n#Perform post-hoc test if you have groups (which didnt work for me - was in a hurry)\n#pairwise.t.test(body_temperature$tidy_q1, Sex$tidy_q1, p.adjust.method='holm',paired=FALSE)\n```\n*Results for the association between gender and body temperature:*\nt = 2.3204, df = 127.52, p-value = 0.02191\nConfidence interval = 95% (0.024 to 0.302)\n\nThe difference between the two means is significant because the t-value is greather than that in a lookup table, with degrees of freedom being about 128 and p value = 0.05.\nTherefore we reject the null hypothesis and accept the alternative hypothesis.\n\n*Results for the association between gender and heart rate:*\nt = 0.6319, df = 116.7, p-value = 0.5287\nConfidence interval = 95% (-1.6745 to 3.2437)\n\nThe difference between the two means is not significant because the t-value is greather than that in a lookup table, with degrees of freedom being about 117 and p value = 0.05.\nTherefore we accept the null hypothesis.\n\n*Interpretation of results:*\nThere is an association between gender and body temperature, however there is no significant association between gender and heart rate.\n\n\n#Question 2\n\n*Null Hypothesis:* There is no association between handedness and ataxic walking in intoxicated individuals.\n\n*Alternative Hypothesis:* There is  an association between handedness and ataxic walking in intoxicated individuals.\n\nThere are 2 groups of unpaired data (right and left handedness), and the data is categorical and nominal. \n\nThe mean and median are not similar for both variables (\"first stumble\" and \"final position\"), so I can conclude the data is non-parametric. Therefore, I will perform a Fishers-Exact. The assumptions for this test are as follows:\n1) the sampling was done randomly\n2) the observations are independent\n3) there is a large sample with adequate expected cell counts\n  for a 2 x 2 table: Expected >= 5 in all cells\n4) it assumes the discrete probability of observed frequencies in the table can be approxiamtaed by the continuous chi-squared value  \n```{r chunk2, echo=TRUE}\n#Read directly from URL\ndata_q2 <- read.csv('https://dl.dropboxusercontent.com/u/11805474/painblogr/biostats/exam-data-2016/question2.csv')\n\n#Load data into a data frame table\ntable_q2 <- tbl_df(data_q2)\n\n#Tidy the data\n##Add a coloumn for change in direction\nmutate_q2 <- mutate(table_q2, 'change' = first_stumble + final_position)\n\n##Select columns being used for simplicity\nfinal_q2 <- select(mutate_q2, handedness, change)\n\n##Add column for presence of ataxia \n#ataxia_q2 <- mutate(final_q2, if(change==1){ataxia='present'}, if(change==0 | change=2){ataxia='absent'})\n\n#The above ataxia_variable creation did not work with the mutate function, and so I manually analysed the data and created my own dataset in a text document\n#Import text dataset\nimport_q2 <- read.table('question2ataxia.txt',\n                 header = TRUE)\n\nsummary(import_q2)\n\n#Quicklook at data\n#Cross tabulate data into a contingency table, where a change in direction = 1, while no change in direction = 0; right-handedness = 1 and left-handedness = 0\nxtab_q2 <- xtabs(~Handedness+Change, data=import_q2)\n\n#Performs Fisher's test\nfisher.test(xtab_q2) \n\n```\n*Results for Fisher's Exact:*\nOdds ratio = 1.08\np-value = 0.8675 and this is not a statistically significant value.\nn = 151\nConfidence interval: 95% (0.531 to 2.200)\nTherefore we accept the null hypothesis.\n\n*Interpretation of results:*\nThere is no association between handedness and ataxic walking in intoxicated individuals.\n\n\n#Question 3\n\n*Null Hypothesis:* There is no association between running time and calories consumed during the run.\n\n*Alternative Hypothesis:* There is an association between running time and calories consumed during the run.\n\nThe data being analysed is numerical and continous. The data is normally distributed and homoskedastic (as calculated below).\nA linear regression will be performed (the data looks fairly linear, hence we can assume there is a correlation).\nThe assumptions for this test are as follows:\n1) A linear trend exists between running time (x) and calories consumed (y)\n2) The observations in the sample are independent\n3) Running time (x) is measured without error\n4)The residuals are normally distributed, and they have the same variance for all fitted values of calories consumed (y)\n```{r chunk3, echo=TRUE}\n#Load packages\nlibrary(readr)\nlibrary(dplyr)\nlibrary(tidyr)\n\n#Read directly from URL\ndata_q3 <- read.csv('https://dl.dropboxusercontent.com/u/11805474/painblogr/biostats/exam-data-2016/question3.csv')\n\n#Load data into a data frame table\ntable_q3 <- tbl_df(data_q3)\n#Print table from above\ntable_q3\n\n#Plot the data\nplot(x = table_q3$time, y = table_q3$calories)\n\n#Pearson's correlation\npearson<- cor.test(table_q3$time, table_q3$calories, method='pearson')\n#Regression analysis\nmodel_q3 <- lm(calories~time, data=table_q3)\nsummary(model_q3)\n\n#Perform diagnostics \n##Use QQ-plot to find normality of residuals\nqqnorm(model_q3$residuals)\nqqline(model_q3$residuals)\n\n##Determine if data is homoskedastic using a fitted vs. residual plot and add abline to visualise the spread\nplot(y = model_q3$residuals, x = model_q3$fitted)\nabline(h=0)\nabline()\n\n###The data is normal (however not very pretty on the graph)\n###The data is homoskedastic as the data points are more or less spread evenly on either side\n```\n*Results from regression analysis:*\nR-squared = 30.17\nF-statistic = 14.22; df = 17; p-value = 0.002 (rounded to 3dp)\n\n*Interpretation of results:*\nTherefore, the p-value of the overall F-test is significant, and the regression model predicts the response variable better than the mean of the response.\n\n#Question 4\n\n```{r chunk4, echo=TRUE}\n#Load packages\nlibrary(readr)\nlibrary(dplyr)\nlibrary(tidyr)\n\n#Load fake dataset\nfoo <- rnorm(10000, mean = 60, sd = 3) # final mark\nbar <- rnorm(10000, mean = 68, sd = 5) # project mark\nbaz <- rep(seq(from = 1997, to = 2006), each = 1) # years\n\nyear <- sample(baz, 150, replace = TRUE,\n               prob = c(0.05, 0.05, 0.08, 0.08, \n                          0.1, 0.13, 0.14, 0.13, 0.12, 0.12))\nproject_mark <- sample(bar, 150, replace = TRUE)\nfinal_mark <- sample(foo, 150, replace = TRUE)\n\nplot_data <- data_frame(year = year,\n                        project_mark = round(project_mark, 1),\n                        final_mark = round(final_mark, 1)) %>%\n    arrange(year)\n\n\n#Load data into a data frame table\ntable_q4 <- tbl_df(plot_data)\n\n#Open new file device to save plot in\npdf(file='marks.pdf')\n\n#Plot black and white, publishable figure\nplot(x = project_mark, y=final_mark, \n     xlab= \"Project Mark (%)\", \n     ylab=\"Final Mark (%)\", \n     xlim=c(50,85), \n     ylim=c(50,75), \n     main= \"The relationship between project mark and final mark\", \n     cex.main=1.5,\n     cex=0.8,\n     pch=16)\n\n#Save and close the image\ndev.off('marks.pdf')\n\n```\n",
    "created" : 1472629251698.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4230811025",
    "id" : "4B627911",
    "lastKnownWriteTime" : 1472645794,
    "last_content_update" : 1472645794711,
    "path" : "~/Desktop/STATS/STATS_EXAM/ExamKristinNel.Rmd",
    "project_path" : null,
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}